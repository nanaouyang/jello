<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.api.jello.dao.ArticleDao">
    <select id="listArticle" resultType="com.api.jello.entity.Article">
        SELECT T_ARTICLE.id,
               T_ARTICLE.title,
               T_ARTICLE.view_count,
               T_ARTICLE.tag,
               T_ARTICLE.create_by,
               T_ARTICLE.update_by,
               T_ARTICLE.create_time,
               T_ARTICLE.update_time,
               T_ARTICLE.ORDER_NUM
        FROM T_ARTICLE
        WHERE T_ARTICLE.IS_DELETE = 0
        ORDER BY T_ARTICLE.ORDER_NUM DESC,
                 T_ARTICLE.create_time DESC
    </select>
    <select id="getTags" resultType="com.api.jello.vo.Tags">
        SELECT count(TAG)    AS count,
               SYS_DICT.CODE AS code,
               SYS_DICT.NAME AS tag
        FROM T_ARTICLE
                 LEFT JOIN SYS_DICT ON tag = SYS_DICT.CODE
        WHERE T_ARTICLE.IS_DELETE = 0
        GROUP BY SYS_DICT.NAME,
                 SYS_DICT.CODE
    </select>
    <select id="getArchives" resultType="com.api.jello.entity.Article">
        select id,TITLE,CREATE_TIME,TAG from T_ARTICLE where IS_DELETE=0
        <if test="code != null and code != ''">
            and T_ARTICLE.tag=#{code}
        </if>
        ORDER BY CREATE_TIME DESC
    </select>
    <select id="getArticle" parameterType="string" resultType="com.api.jello.entity.Article">
        SELECT ARTICLE.ID,
               ARTICLE.TITLE,
               ARTICLE.CONTENT,
               ARTICLE.UPDATE_TIME,
               DICT.CODE AS TAG,
               DICT.NAME AS TAGDESC
        FROM T_ARTICLE ARTICLE
                 LEFT JOIN SYS_DICT DICT ON ARTICLE.TAG = DICT.CODE
        WHERE ARTICLE.IS_DELETE = 0
          AND ARTICLE.ID = #{id}
    </select>
</mapper>